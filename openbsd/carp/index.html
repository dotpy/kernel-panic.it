<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="../../css/fonts.css">
    <link rel="stylesheet" href="../../css/kp.css" />
    <link rel="stylesheet" href="../../css/docs.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

    <meta name="description" content="Redundant firewalls setup with OpenBSD, CARP and pfsync" />
    <meta name="keywords" content="kernel,panic,OpenBSD,firewall,cluster,PF,CARP,pfsync,security,docs" />
    <meta name="distribution" content="Global" />
    <meta name="author" content="Daniele Mazzocchio, danix@kernel-panic.it" />
    <meta name="copyright" content="This document copyright 2005-2021 by Kernel-Panic.it." />

    <title>Redundant firewalls with OpenBSD, CARP and pfsync - Table of contents</title>
  </head>
  <body>
    <div id="container">
    <div id="header">Kernel Panic</div>
    <div id="sub-container">
      <div id="sidebar">
        <ul>
          <li><a class="menu" href="../../index.html"><img src="../../images/home_icon.png" /><span>Home</span></a></li>
          <li><a class="menu" href="../../openbsd.html"><img src="../../images/obsd_icon.png" /><span>OpenBSD</span></a></li>
          <li><a class="menu" href="../../linux.html"><img src="../../images/linux_icon.png" /><span>Linux</span></a></li>
          <li><a class="menu" href="../../email.html"><img src="../../images/email_icon.png" /><span>Email</span></a></li>
          <li><a class="menu" href="../../security.html"><img src="../../images/lock_icon.png" /><span>Security</span></a></li>
          <li><a class="menu" href="../../programming.html"><img src="../../images/coffee_icon.png" /><span>Programming</span></a></li>
        </ul>
      </div>
      <div id="main">
        <div id="content">
          <div class="nav">
            <div class="nav-back"></div>
            <div class="nav-title"></div>
            <div class="nav-next"><a href="carp1.html">1. Base configuration<img src="../../images/right_arrow.png"/></a></div>
          </div>

          <h2>Redundant firewalls with OpenBSD, CARP and pfsync</h2>
          <div id="subtitle">Author: <a href="mailto:danix@kernel-panic.it">Daniele Mazzocchio</a><br />
                             Applies to: OpenBSD 6.8<br />
                             Last update: Dec 12, 2020
          </div>

          <div id="toc">
            <h3>Table of contents</h3>

            <ul>
              <li><a href="carp1.html">1. Base configuration</a></li>
              <li><a href="carp2.html">2. The CARP protocol</a>
                <ul>
                  <li><a href="carp2.html#carp-2.1">2.1 Configuration parameters</a>
                    <ul>
                      <li><a href="carp2.html#carp-2.1.1">2.1.1 The demotion counter</a></li>
                      <li><a href="carp2.html#carp-2.1.2">2.1.2 Load balancing</a></li>
                    </ul>
                  </li>
                  <li><a href="carp2.html#carp-2.2">3.2 Parameters configuration</a>
                    <ul>
                      <li><a href="carp2.html#carp-2.2.1">2.2.1 Active/standby mode</a></li>
                      <li><a href="carp2.html#carp-2.2.2">2.2.2 Active/active mode</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li><a href="carp3.html">3. The pfsync protocol</a></li>
              <li><a href="carp4.html">4. PF rules!</a></li>
              <li><a href="carp5.html">5. Appendix</a>
                <ul>
                  <li><a href="carp5.html#carp-5.1">5.1 References</a></li>
                  <li><a href="carp5.html#carp-5.2">5.2 Bibliography</a></li>
                </ul>
              </li>
            </ul>
          </div>

          <p>Firewalls are among the most critical security components in your network, as they allow for fine-grained control over what traffic is flowing through your cables, but they can become a security issue as well, if they end up being a single point of failure.</p>
          <p>Using firewall clusters can dramatically reduce the odds of a major downtime, making the failure of a firewall completely transparent to users. Also, maintenance (patching, upgrading, rebooting...) becomes much easier and faster when relying on a backup machine, thus indirectly increasing systems security and reliability.</p>
          <p>On the downside, however, it's true that redundancy increases hardware costs and can't solve all problems, like transparent transfer of certain protocols between systems or synchronizing data between clustered machines (as a matter of fact, we will rely on two different protocols for <a href="carp3.html">failover</a> and <a href="carp4.html">synchronization</a> of firewall states).</p>
          <p>The tools we will use to build our firewall cluster are:</p>

          <dl class="padded">
            <dt><a href="http://www.openbsd.org/">OpenBSD</a></dt>
            <dd>it is largely considered one of the most secure OSes around, with <q>only two remote holes in the default install, in a heck of a long time!</q>;</dd>
            <dt><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">Packet Filter</a> (PF)</dt>
            <dd>OpenBSD's system for filtering TCP/IP traffic and doing Network Address Translation;</dd>
            <dt><a href="https://man.openbsd.org/carp">CARP</a> (Common Address Redundancy Protocol)</dt>
            <dd>the protocol that achieves system redundancy, by having multiple computers creating a single, virtual network interface between them;</dd>
            <dt><a href="https://man.openbsd.org/pfsync">pfsync</a></dt>
            <dd>the protocol that allows PF state tables to be synchronized between multiple firewalls.</dd>
          </dl>

          <p>A good knowledge of OpenBSD and PF is assumed, since we won't cover topics like <a href="https://man.openbsd.org/pfctl"><tt>pfctl(8)</tt></a> and <a href="https://man.openbsd.org/pf.conf"><tt>pf.conf(5)</tt></a> syntax. Anyway, the <a href="carp6.html">appendix</a> contains some useful links for more on these topics.</p>

          <div class="nav">
            <div class="nav-back"></div>
            <div class="nav-title"></div>
            <div class="nav-next"><a href="carp1.html">1. Base configuration<img src="../../images/right_arrow.png"/></a></div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
